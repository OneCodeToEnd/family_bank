# 账单导入

账清支持多种方式导入账单，快速批量录入交易记录。

## 导入方式

### 文件导入

支持从CSV或Excel文件导入账单：
- **CSV文件**：逗号分隔值文件
- **Excel文件**：.xlsx 或 .xls 格式

### 邮箱导入

从邮箱自动获取账单：
- 支持IMAP协议
- 自动解析账单附件
- 定期自动同步

---

## 文件导入

### 准备文件

**文件格式要求：**
- CSV文件使用UTF-8编码
- Excel文件为标准格式
- 包含必需字段：日期、金额、描述

**示例CSV格式：**
```csv
交易时间,交易类型,金额,商户,备注
2026-02-01 10:30:00,支出,25.50,美团外卖,午餐
2026-02-01 15:20:00,支出,15.00,星巴克,咖啡
2026-02-02 09:00:00,收入,5000.00,公司,工资
```

### 导入步骤

1. 进入"导入"页面
2. 点击"文件导入"
3. 选择CSV或Excel文件
4. 映射字段（首次导入需要）
5. 预览导入数据
6. 确认并导入

### 字段映射

首次导入需要映射字段：

**必需字段：**
- **交易时间**：交易发生的日期时间
- **金额**：交易金额
- **描述**：交易说明

**可选字段：**
- **交易类型**：收入/支出
- **分类**：交易分类
- **账户**：支付账户
- **交易对方**：商家或收款方
- **备注**：补充说明

映射配置会自动保存，下次导入同类文件时无需重新配置。

### 数据预览

导入前可以预览：
- 识别的交易记录数
- 字段映射结果
- 数据格式是否正确
- 重复交易提示

### 导入结果

导入完成后显示：
- **成功导入**：新增的交易数量
- **重复跳过**：已存在的交易数量
- **失败记录**：格式错误的记录

---

## 邮箱导入

### 配置邮箱

1. 进入"设置" → "邮箱配置"
2. 点击"添加邮箱"
3. 填写邮箱信息：
   - **邮箱地址**：完整的邮箱地址
   - **IMAP服务器**：邮箱服务商的IMAP地址
   - **端口**：通常为993（SSL）
   - **密码**：邮箱密码或授权码
4. 测试连接
5. 保存配置

### 常见邮箱配置

**QQ邮箱：**
- 服务器：imap.qq.com
- 端口：993
- 需要开启IMAP服务并使用授权码

**163邮箱：**
- 服务器：imap.163.com
- 端口：993
- 需要开启IMAP服务并使用授权码

**Gmail：**
- 服务器：imap.gmail.com
- 端口：993
- 需要开启IMAP并使用应用专用密码

### 获取账单

1. 进入"导入"页面
2. 点击"邮箱导入"
3. 选择已配置的邮箱
4. 设置获取时间范围
5. 点击"获取账单"
6. 系统自动：
   - 连接邮箱服务器
   - 搜索账单邮件
   - 下载账单附件
   - 解析账单数据
   - 导入交易记录

### 自动同步

配置自动同步：
1. 在邮箱配置中启用"自动同步"
2. 设置同步频率（每天/每周）
3. 系统会定期自动获取新账单

---

## 智能去重

### 去重机制

系统使用SHA-256哈希进行去重：
- 基于：账户ID + 交易时间 + 金额 + 描述
- 自动识别重复交易
- 避免重复导入

### 去重策略

- **完全相同**：直接跳过
- **部分相同**：提示用户确认
- **不同来源**：保留导入来源标记

---

## 数据验证

### 自动验证

导入时系统会验证：
- **日期格式**：是否为有效日期
- **金额格式**：是否为有效数字
- **必需字段**：是否完整
- **数据类型**：是否符合要求

### 错误处理

对于验证失败的记录：
- 显示错误原因
- 提供修正建议
- 可以手动修正后重新导入

---

## 导入后处理

### 分类匹配

导入的交易会自动尝试匹配分类：
1. 使用关键词规则匹配
2. 使用AI智能分类（如已配置）
3. 未匹配的标记为"未分类"

### 交易确认

导入的交易默认为"未确认"状态：
- 需要人工审核
- 确认后才计入统计
- 可批量确认

### 数据清理

建议导入后：
- 检查未分类的交易
- 确认交易信息准确
- 删除错误或测试数据

---

## 最佳实践

### 文件导入

- 使用UTF-8编码
- 保持字段名称一致
- 定期备份原始文件

### 邮箱导入

- 使用专用邮箱接收账单
- 定期清理邮箱
- 保护邮箱密码安全

### 数据管理

- 导入前备份数据
- 定期检查导入结果
- 及时处理未分类交易

---

## 故障排除

### 文件导入失败

**问题**：文件无法导入或格式错误

**解决方案**：
- 检查文件编码（应为UTF-8）
- 确认必需字段完整
- 验证日期和金额格式
- 尝试使用示例模板

### 邮箱连接失败

**问题**：无法连接邮箱服务器

**解决方案**：
- 验证IMAP服务器地址和端口
- 检查邮箱密码或授权码
- 确认已开启IMAP服务
- 检查网络连接

### 重复导入

**问题**：同一笔交易被重复导入

**解决方案**：
- 系统会自动去重
- 如仍有重复，手动删除
- 检查去重字段是否一致

---

## 相关功能

- [交易记录](transactions.md) - 管理导入的交易
- [分类系统](categories.md) - 为导入交易分类
- [AI智能分类](ai-classification.md) - 自动分类导入交易