# 常见问题

本页面收集了使用账清应用时的常见问题和解决方案。

## 安装与环境

### Flutter doctor显示错误

**问题**: 运行 `flutter doctor` 时显示某些组件未安装或配置不正确

**解决方案**:
1. 根据提示安装缺失的组件
2. Android开发: 安装Android Studio和Android SDK
3. iOS/macOS开发: 从App Store安装Xcode
4. 安装CocoaPods: `sudo gem install cocoapods`

### 依赖安装失败

**问题**: `flutter pub get` 命令失败

**解决方案**:
```bash
flutter clean
flutter pub get
```

如果问题持续，尝试删除 `pubspec.lock` 文件后重试。

### iOS/macOS构建失败

**问题**: Pod安装失败或构建错误

**解决方案**:
```bash
cd ios
pod install
pod update
cd ..
flutter clean
flutter run
```

### Android构建失败

**问题**: Gradle同步失败或构建错误

**解决方案**:
1. 检查 `android/local.properties` 中的SDK路径是否正确
2. 在Android Studio中打开项目并同步Gradle
3. 清理并重新构建:
```bash
flutter clean
flutter pub get
flutter build apk
```

---

## 数据库相关

### 数据库错误或数据丢失

**问题**: 应用启动时报数据库错误，或数据突然丢失

**解决方案**:

**开发环境**:
- 卸载应用后重新安装
- 数据库会自动重新创建

**生产环境**:
1. 检查数据库版本是否正确
2. 查看数据库升级逻辑是否有问题
3. 如果有备份，尝试恢复备份数据

### 数据库升级失败

**问题**: 应用更新后数据库升级失败

**解决方案**:
1. 查看错误日志确定具体问题
2. 检查 `DatabaseService._onUpgrade()` 中的升级逻辑
3. 确保从旧版本到新版本的升级路径完整

---

## AI分类相关

### AI分类不工作

**问题**: 点击AI分类按钮后没有反应或报错

**解决方案**:
1. 验证API密钥是否正确配置
2. 检查网络连接是否正常
3. 查看HTTP日志（设置 → AI设置 → 查看日志）
4. 确认AI服务商的API服务是否正常

### AI分类结果不准确

**问题**: AI返回的分类建议不符合预期

**解决方案**:
1. 自定义提示词，提供更详细的分类说明
2. 使用"自动学习"功能，修正错误分类后系统会自动学习
3. 结合关键词规则提高准确率

### API调用失败

**问题**: 显示"API调用失败"错误

**解决方案**:
1. 检查API密钥是否过期
2. 确认账户余额是否充足
3. 查看HTTP日志了解具体错误信息
4. 尝试切换到其他AI提供商

---

## 账单导入相关

### 文件导入失败

**问题**: CSV或Excel文件导入时报错

**解决方案**:
1. 确认文件格式正确（UTF-8编码）
2. 检查必需字段是否完整（日期、金额、描述）
3. 确保日期格式正确
4. 金额字段不包含货币符号

### 邮箱导入失败

**问题**: 无法连接邮箱或获取账单失败

**解决方案**:
1. 验证IMAP服务器地址和端口是否正确
2. 检查邮箱密码（某些邮箱需要应用专用密码）
3. 确认已开启IMAP服务
4. 检查网络连接和防火墙设置

常见邮箱IMAP配置:
- **QQ邮箱**: imap.qq.com:993 (需要授权码)
- **163邮箱**: imap.163.com:993 (需要授权码)
- **Gmail**: imap.gmail.com:993 (需要应用密码)

### 导入重复数据

**问题**: 同一笔交易被重复导入

**解决方案**:
- 应用使用SHA-256哈希进行自动去重
- 如果仍出现重复，检查账户、时间、金额、描述是否完全一致
- 手动删除重复的交易记录

---

## 备份与同步

### 备份导出失败

**问题**: 无法导出备份文件

**解决方案**:
1. 检查存储权限是否授予
2. 确保有足够的存储空间
3. 尝试更换保存位置

### WebDAV同步失败

**问题**: WebDAV连接测试失败或同步错误

**解决方案**:
1. 验证服务器地址格式（需要包含协议，如 https://）
2. 检查用户名和密码是否正确
3. 确认WebDAV服务器支持的认证方式
4. 查看服务器日志了解具体错误

### 数据恢复失败

**问题**: 导入备份文件后数据未恢复

**解决方案**:
1. 确认备份文件未损坏
2. 检查备份文件版本是否兼容当前应用版本
3. 如果备份加密，确保密码正确

---

## 性能问题

### 应用启动慢

**问题**: 应用启动需要较长时间

**解决方案**:
1. 清理应用缓存
2. 检查数据库大小，考虑归档旧数据
3. 关闭不必要的自动同步功能

### 交易列表加载慢

**问题**: 打开交易列表时响应缓慢

**解决方案**:
1. 使用日期筛选减少加载数据量
2. 定期清理测试数据
3. 检查数据库索引是否正常

---

## 其他问题

### 找不到某个功能

**问题**: 文档中提到的功能在应用中找不到

**解决方案**:
1. 确认应用版本是否支持该功能
2. 某些功能可能需要先配置（如AI分类需要先配置API密钥）
3. 查看功能特性文档了解详细说明

### 数据安全性

**问题**: 担心数据安全和隐私

**解答**:
- 所有数据存储在本地SQLite数据库
- 不上传任何数据到服务器
- 支持数据库加密（AES-256）
- API密钥自动加密存储
- 备份文件可选加密

### 如何贡献代码

**问题**: 想要为项目贡献代码

**解答**:
1. Fork项目到您的GitHub账户
2. 创建功能分支
3. 提交Pull Request
4. 查看 [开发指南](../development/setup.md) 了解详细流程

---

## 获取帮助

如果以上解决方案无法解决您的问题:

1. 查看 [GitHub Issues](https://github.com/OneCodeToEnd/family_bank/issues)
2. 提交新的Issue并提供详细信息:
   - 应用版本
   - 操作系统和版本
   - 复现步骤
   - 错误日志
3. 参与社区讨论